//* SQL project - Covid 19 data exploration

Tools used: SQL, google sheets
Skills used: Select, Where, Joins, CTE's, Temp Tables, Windows Functions, Aggregate Functions, Creating Views, Converting Data Types

*//

--In this section I query to look at total cases vs Total deaths in Canada, and orderer the information

Select location, date, total_cases,total_deaths, (total_deaths/total_cases)*100) AS DeathPercentageFromCovid
From PortfolioProject.dbo.CovidDeaths
Where location like '%Canada%'
order by location,date


-- This query will show countries with highest infection rate (at any point in time) compared to population

Select location, population, max(total_cases) AS HighestInfectionCount,  
	MAX((total_cases/population))*100 as MaxPercentagePopulationInfected
from PortfolioProject.dbo.CovidDeaths
Group by Location, population
order by MaxPercentagePopulationInfected desc

//*
--In the case above, I noticed that there where many null values and also some countries had a percentage of infection higher than 100%
--This meant that I had to make some data cleaning, so I filtered in Excel the few countries that had this problem (Venezuela, Poland, Moroco, Saudi Arabia, etc.)
--I noticed some dirty data, in which population was extremely short (i.e. Venezuela had 480 population in a few cells) making the Max (total_cases/population) 
--extremely high, so I just filtered and replaced the dirty data from these countries 
*//



-- highest death count

select location, max(cast(Total_deaths as int)) as TotalDeathCount
from PortfolioProject.dbo.CovidDeaths
where continent is not null --this get rid of continents and null data
Group by Location
order by TotalDeathCount desc

--Result above was compared searching in google and the numbers up to the date are really close (i.e. USA 960 k vs 962k, probably becuas eof the few days on difference)

-- Doing by continent

select location, max(cast(Total_deaths as int)) as TotalDeathCount
from PortfolioProject.dbo.CovidDeaths
where continent is null -- above I used not null to avoid continents, now I want null to get continents
AND location is not Null and location not like '%income%' 
and location not like 'international' -- not like to avoid locations that are not continents (with the exception of world)
Group by location
order by TotalDeathCount d







